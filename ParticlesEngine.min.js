!function(a){initParticleEngine=function(b){"use strict";var c=a.requestAnimationFrame||function(a){return setTimeout(a,1e3/60)},d=a.cancelAnimationFrame||a.clearTimeout,e=function(){d(a.particleEngine["animation"+b])},f=document.getElementById(b);if(null===f)return console.error("ParticlesEngine Error - Container is Null");var g=document.createElement("canvas");g.id="particles_"+b,g.style.display="block",g.style.position="absolute",f.innerHTML="",f.style.overflow="hidden",f.appendChild(g);var h,i=g.getContext("2d"),j={},k=0,l=[],m=[],n={};n.events={},n.emit=function(a,b){!this.events[a]||this.events[a].length<1||this.events[a].forEach(function(a){a(b||{})})},n.subscribe=function(a,b){this.events[a]||(this.events[a]=[]),this.events[a].push(b)};var o=function(){"undefined"==typeof a.particleEngine?(a.particleEngine=j,j.resizeHandler={}):"undefined"!=typeof j["animation"+b]&&(e(j["animation"+b]),a.removeEventListener("resize",j.resizeHandler["animation"+b],!1)),j.resizeHandler["animation"+b]=function(){e(j["animation"+b]),p()},a.addEventListener("resize",j.resizeHandler["animation"+b],!1)},p=function(){g.width=f.clientWidth,g.height=f.clientHeight,h=Math.round(Math.sqrt(g.width*g.width+g.height*g.height)),l.length=0,m.length=0,n.emit("init"),C()},q=function(){var a={};return a.init=function(){var a=function(a){"gradient"===a&&b()},b=function(){var a,b="";for(var c in y.backgroundColors)"undefined"==typeof a&&(a=y.backgroundColors[c].color),y.backgroundColors.hasOwnProperty(c)&&(b+="radial-gradient(circle at "+y.backgroundColors[c].positionX+"% "+y.backgroundColors[c].positionY+"%, #"+y.backgroundColors[c].color+", transparent 100%),");b=b.slice(0,-1),f.style.background="#"+a,f.style.backgroundImage=b},c=function(){null!==y.background&&a(y.background)};n.subscribe("init",c)},a}(),r=function(){var a={};return a.init=function(){var a=function(){},b={positionX:0,positionY:0,positionXpx:0,positionYpx:0,particlesNumber:20,lifeTime:1};a.prototype.init=function(a){this.name="emitter"+m.length;for(var c in b)this[c]=a.hasOwnProperty(c)?a[c]:b[c]},a.prototype.update=function(){this.lifeTime&&this.lifeTime--,this.lifeTime<=0&&this.destroy()},a.prototype.destroy=function(){for(var a=0;a<l.length;a++){var b=l[a];b.emitter===this.name&&b.destroy()}var c=m.indexOf(this);m.splice(c,1)};var c=function(a,b){this.init(a);for(var c=0;c<this.particlesNumber;c++){var d=Math.floor(Math.random()*g.width+1),e=Math.floor(Math.random()*g.height+1),f=new z.Particle(d,e,this.name);f.init(b)}};c.prototype=a.prototype;var d=function(a,b){this.init(a);var c,d,e,f;e=this.positionX?g.width/100*this.positionX:0,f=this.positionY?g.height/100*this.positionX:0,c=e+this.positionXpx,d=f+this.positionYpx;for(var h=0;h<this.particlesNumber;h++){var i=new z.Particle(c,d,this.name);i.init(b)}};d.prototype=a.prototype;var e=function(a,b,e){var f;"point"===a?f=new d(b,e):"random"===a&&(f=new c(b,e)),m.push(f)};j.addEmitter=e},a}(),s=function(){var a={};return a.init=function(){z.Particle.prototype.fadeTo=function(a){this.opacity<a?(this.opacity=this.opacity+.01,this.opacity>1&&(this.opacity=1)):this.opacity>a&&(this.opacity=this.opacity-.01)},z.Particle.prototype.fadeIn=function(){this.active=!0,-1===this.actions.indexOf("fadeIn")&&this.actions.push("fadeIn"),this.fadeTo(this.initialOpacity),this.initialOpacity-this.opacity<=0&&this.actions.splice(this.actions.indexOf("fadeIn"),1)},z.Particle.prototype.fadeOut=function(){this.isFading=!0,-1===this.actions.indexOf("fadeOut")&&this.actions.push("fadeOut"),this.opacity<.05&&(this.opacity=0,this.isFading=!1,this.active=!1,this.actions.splice(this.actions.indexOf("fadeOut"),1)),this.fadeTo(0)}},a}(),t=function(){var a={};return a.init=function(){z.Particle.prototype.appendGlobalForces=function(a,b){this.positionX=this.positionX+a,this.positionX+this.size>g.width&&(this.positionX=g.width-this.size),this.positionX<0&&(this.positionX=0),this.positionY=this.positionY+b,this.positionY>g.height&&(this.positionY=g.height),this.positionY<0&&(this.positionY=0)}},a}(),u=function(){var a={};return a.init=function(){var a,b,c,d=0,e=0,f=function(){if(!a)return a=Date.now(),void(b=0);var f=((new Date).getTime()-a)/1e3;a=Date.now(),b=Math.floor(1/f),d+=b,e++,5===e&&(c=Math.floor(d/5),e=0,d=0),c&&(i.fillStyle="#fff",i.font="10px Verdana",i.fillText("FPS: "+b,10,g.height-70),i.fillText("Average FPS: "+c,10,g.height-60),i.fillText("Active particles: "+l.length,10,g.height-50),i.fillText("Active emitters: "+m.length,10,g.height-40),i.fillText("Connections between particles: "+k,10,g.height-30),k=0)};n.subscribe("requestStatistics",f)},a}(),v=function(){var a={};return a.init=function(){var b=0;a.increase=function(){b++},a.collectGarbage=function(){for(var a=l.length-1;a>=0;a--){var c=l[a];c.destroyIt!==!0||c.active||l.splice(a,1)}b=0},n.subscribe("refreshScene",function(){b>100&&a.collectGarbage()})},a}(),w=function(){var a={};return a.init=function(){a.getRandomBetween=function(a,b){return Math.floor(Math.random()*(b-a+1))+a},a.getRandomDecimalBetween=function(a,b){b=100*b,a=100*a;var c=this.getRandomBetween(a,b),d=c/100;return d},a.hitTest=function(a,b){return a.positionX<b.positionX+b.size&&a.positionX+b.size>b.positionX&&a.positionY<b.positionY+b.size&&a.positionY>b.positionY?!0:!1},a.getDistance=function(a,b){var c=Math.round(Math.abs(a.positionX-b.positionX)),d=Math.round(Math.abs(a.positionY-b.positionY));return Math.round(Math.sqrt(c*c+d*d))}},a}(),x=function(){var a={};return a.init=function(){a.Interaction=function(){};var b=new a.Interaction,c=[];a.Interaction.prototype.grabElements=function(){c=[];for(var a=0;a<l.length;a++){var b=l[a],d=w.getDistance(this,b);d<y.mouseInteractionDistance&&c.push(l[a])}},a.Interaction.prototype.interact=function(){for(var a=0;a<c.length;a++){var b=c[a];y.drawMouseConnections&&d(this,b),"gravity"===y.mouseInteractionType?(b.vectorX=this.positionX,b.vectorY=this.positionY):"initial"===y.mouseInteractionType&&(b.vectorX=b.initialPositionX,b.vectorY=b.initialPositionY)}};var d=function(a,b){i.beginPath(),i.moveTo(a.positionX,a.positionY),i.lineTo(b.getCenterX(),b.getCenterY()),i.strokeStyle="rgba("+y.mouseConnectionColor.red+","+y.mouseConnectionColor.green+","+y.mouseConnectionColor.blue+","+y.mouseConnectionColor.alpha+")",i.stroke()};a.Interaction.prototype.updateAnimation=function(){this.positionX=j.mousePositionX,this.positionY=j.mousePositionY,this.grabElements(),this.interact()};var e=function(){b.updateAnimation()};y.mouseInteraction&&y.mouseInteractionDistance>0&&n.subscribe("refreshScene",e)},a}(),y={particleType:"square",particleText:"!",emitterType:"point",emitterPositionX:50,emitterPositionY:50,emitterPositionXpx:200,emitterPositionYpx:200,particlesNumber:1,initialSize:3,randomSize:!0,minimumSize:1,maximumSize:3,moveLimit:300,durationMin:50,durationMax:200,lifeTimeMin:10,lifeTimeMax:10,globalForceX:5,globalForceY:-1,particleColor:{red:255,green:255,blue:255,alpha:1},randomOpacity:!0,particleMinimumOpacity:.1,particleMaximumOpacity:.9,drawConnections:!1,connectionColor:{red:255,green:255,blue:255,alpha:1},mouseInteraction:!1,mouseInteractionType:"gravity",drawMouseConnections:!1,mouseInteractionDistance:300,mouseConnectionColor:{red:255,green:255,blue:255,alpha:1},showStatistics:!0,background:"gradient",backgroundColors:{color1:{positionX:25,positionY:25,color:"FF9900"},color2:{positionX:60,positionY:60,color:"FFE066"}}},z=function(){var a={};return a.init=function(){a.Particle=function(a,b,c){this.positionX=a,this.positionY=b,this.initialPositionX=a,this.initialPositionY=b,this.emitter=c},a.Particle.prototype.doActions=function(){for(var a=0;a<this.actions.length;a++){var b=this.actions[a];this[b]()}},a.Particle.prototype.destroy=function(){this.destroyIt=!0,v.increase()},a.Particle.prototype.calculateNewPosition=function(a,b){var c,d=this.duration,e=function(a,b){return a>b?(c=(a-b)/d,a=b+c):(c=(b-a)/d,a=b-c),a};this.positionX=e(a,this.positionX),this.positionY=e(b,this.positionY),this.timer===this.duration?(this.calculateVector(),this.timer=0):this.timer++},a.Particle.prototype.updateColor=function(){this.color="rgba("+this.red+","+this.green+","+this.blue+","+this.opacity+")"},a.Particle.prototype.init=function(a){this.particleConfig=a,this.initOpacity(),this.initSize(),this.red=a.particleColor.red,this.green=a.particleColor.green,this.blue=a.particleColor.blue,this.color="rgba("+this.red+","+this.green+","+this.blue+","+this.opacity+")",this.duration=w.getRandomBetween(a.durationMin,a.durationMax),this.limit=a.moveLimit,this.timer=0,this.lifeTime=b(a.lifeTimeMin,a.lifeTimeMax),this.actions=[],this.calculateVector(),this.active=!0,this.closestDistance=h,l.push(this),this.index=l.indexOf(this)};var b=function(a,b){return"undefined"!=typeof a&&"undefined"!=typeof b?w.getRandomBetween(a,b):!1};a.Particle.prototype.initOpacity=function(){this.opacity=this.particleConfig.randomOpacity?w.getRandomDecimalBetween(this.particleConfig.particleMinimumOpacity,this.particleConfig.particleMaximumOpacity):this.particleConfig.particleColor.alpha,this.initialOpacity=this.opacity},a.Particle.prototype.initSize=function(){this.size=this.particleConfig.randomSize?w.getRandomBetween(this.particleConfig.minimumSize,this.particleConfig.maximumSize):this.particleConfig.initialSize},a.Particle.prototype.calculateVector=function(){for(var a,b={},c=this,d=function(){var d=c.positionX-c.limit,e=c.positionX+c.limit;e>g.width&&(e=g.width),0>d&&(d=0);var f=c.positionY-c.limit,h=c.positionY+c.limit;h>g.height&&(h=g.height),0>f&&(f=0),b.positionX=w.getRandomBetween(d,e),b.positionY=w.getRandomBetween(f,h),a=w.getDistance(c,b)};"undefined"==typeof a||a>this.limit;)d();this.vectorX=b.positionX,this.vectorY=b.positionY},a.Particle.prototype.getCenterX=function(){var a;return"square"===this.particleConfig.particleType?a=this.positionX+.5*this.size:"circle"===this.particleConfig.particleType&&(a=this.positionX),a},a.Particle.prototype.getCenterY=function(){var a;return"square"===this.particleConfig.particleType?a=this.positionY+.5*this.size:"circle"===this.particleConfig.particleType&&(a=this.positionY),a},a.Particle.prototype.testInteraction=function(){for(var a=this.index+1;a<l.length;a++){if(!this.active)return;var b=l[a],c=w.getDistance(this,b);c<this.closestDistance&&b.active===!0&&(this.closestDistance=c,this.closestElement=b),c<b.closestDistance&&(b.closestDistance=c,b.closestElement=this)}},a.Particle.prototype.drawLine=function(){i.beginPath(),i.moveTo(this.getCenterX(),this.getCenterY()),i.lineTo(this.closestElement.getCenterX(),this.closestElement.getCenterY()),i.strokeStyle="rgba("+y.connectionColor.red+","+y.connectionColor.green+","+y.connectionColor.blue+","+y.connectionColor.alpha+")",i.stroke(),k++},a.Particle.prototype.updateLifeTime=function(){this.lifeTime&&this.lifeTime--,0===this.lifeTime&&this.fadeOut()},a.Particle.prototype.updateAnimation=function(){this.calculateNewPosition(this.vectorX,this.vectorY),this.updateColor(),i.fillStyle=this.color,"square"===this.particleConfig.particleType?i.fillRect(this.positionX,this.positionY,this.size,this.size):"circle"===this.particleConfig.particleType?(i.beginPath(),i.arc(this.positionX,this.positionY,this.size,0,2*Math.PI),i.fill(),i.closePath()):"text"===this.particleConfig.particleType&&(i.font=this.size+"px Verdana",i.fillText(y.particleText,this.positionX,this.positionY))}},a}(),A=function(){var a={};return a.init=function(){var b=0,c=function(){if(y.drawConnections&&3===b){b=0;for(var a=0;a<l.length;a++){var c=l[a];c.closestDistance=h,c.closestElement=null}for(var a=0;a<l.length;a++){var c=l[a];c.testInteraction()}}if(y.drawConnections)for(var a=0;a<l.length;a++){var c=l[a];c.closestElement&&c.drawLine()}};a.update=function(){b++,c();for(var a=0;a<l.length;a++){var d=l[a];d.doActions(),d.appendGlobalForces(y.globalForceX,y.globalForceY),d.active?(d.updateAnimation(),d.updateLifeTime()):d.destroyIt||d.active||d.isFading||(d.lifeTime=100,d.positionX=d.initialPositionX,d.positionY=d.initialPositionY,d.calculateVector(),d.timer=0,d.fadeIn())}for(var a=0;a<m.length;a++)m[a].update();n.emit("refreshScene")}},a}();o(),w.init(),v.init(),z.init(),x.init(),r.init(),A.init(),s.init(),t.init(),q.init(),u.init(),g.onmousemove=function(b){j.mousePositionX=b.clientX-f.offsetLeft+a.pageXOffset,j.mousePositionY=b.clientY-f.offsetTop+a.pageYOffset};var B=function(){i.clearRect(0,0,g.width,g.height)},C=function(){B(),A.update(),a.particleEngine["animation"+b]=c(C),y.showStatistics&&n.emit("requestStatistics")};p()},a.initParticleEngine=initParticleEngine}(window);